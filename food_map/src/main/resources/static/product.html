<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>ÂïÜÂìÅÁÆ°ÁêÜ</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="stylesheet" href="/static_resources/element-plus-index.css" />
    <link rel="stylesheet" href="/static_resources/vxe-table-style.css">
    <script src="/static_resources/vue.global.js"></script>
    <script src="/static_resources/element-plus-index.full.js"></script>
    <script src="/static_resources/xe-utils.js"></script>
    <script src="/static_resources/vxe-table@4.6.25.js"></script>
    <script src="/static_resources/axios.min.js"></script>
    <script src="/static_resources/element-plus_icons-vue.js"></script>
    <script src="/static_resources/zh-cn.js"></script>
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon_logosc/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon_logosc/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon_logosc/favicon-16x16.png">
    <link rel="manifest" href="/favicon_logosc/site.webmanifest">
    <style>
        .border-box {
            width: 80%;
            box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);
            margin: auto;
            padding: 30px;
        }

        .border {
            display: flex;
        }

        .border-guige {
            width: 100%;
            border-radius: 2px;
            border: 1px solid rgb(227, 223, 223);
            margin-left: 10px;
            padding: 20px;
        }

        .flex-guige {
            display: flex;
        }

        .name {
            width: 80px;
        }

        .width-input {
            width: 30%;
            margin-left: 20px;
        }

        .width-tag {
            margin-left: 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .el-tag+.el-tag {
            margin-left: 0;
        }

        .button-new-tag {
            height: 25px;
            line-height: 25px;
            padding-top: 0;
            padding-bottom: 0;
            margin-left: 0;
        }

        .input-new-tag {
            width: 90px;
            margin-left: 10px;
            vertical-align: bottom;
        }

        .avatar-uploader .el-upload {
            border: 1px dashed #846767;
            border-radius: 6px;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .avatar-uploader .el-upload:hover {
            border-color: #409EFF;
        }

        .avatar-uploader-icon {
            font-size: 28px;
            color: #8c939d;
            width: 178px;
            height: 178px;
            line-height: 178px;
            text-align: center;
        }

        .avatar {
            width: 178px;
            height: 178px;
            display: block;
        }

        /* Êñ∞Â¢ûÊ†∑Âºè */
        .spec-value-container {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
            gap: 5px;
        }

        .spec-price-input {
            width: 150px;
            height: 25px;
        }

        .map-list-container {
            overflow-x: auto;
        }

        .result-display {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            font-family: monospace;
            word-break: break-all;
            white-space: pre-wrap;
        }

        .sku-img-preview {
            width: 50px;
            height: 50px;
            object-fit: cover;
            margin-right: 5px;
        }
    </style>
</head>
<body>
<div id="app">
    <div class="common-layout">
        <el-container>
            <el-container>
                <el-header>
                    <div class="header-container" style="display: flex; align-items: center; justify-content: start;">
                        <el-avatar :src="`../img/ÈªòËÆ§Â§¥ÂÉè.png`"></el-avatar>
                        <h3 class="user-name">ÁÆ°ÁêÜÂëò</h3>
                    </div>
                </el-header>
            <el-container >
            <el-aside width="200px">
                <el-menu
                        v-model:default-active="itemNumber"
                        class="el-menu-vertical-demo"
                >
                    <el-menu-item index="1" @click="toUserManage">
                        <el-icon><document /></el-icon>
                        <span>Áî®Êà∑ÁÆ°ÁêÜ</span>
                    </el-menu-item>
                    <el-menu-item index="2" @click="toMerchantManage">
                        <el-icon><document /></el-icon>
                        <span>ÂïÜÊà∑ÁÆ°ÁêÜ</span>
                    </el-menu-item>
                    <el-menu-item index="3" @click="toProductManage">
                        <el-icon><document /></el-icon>
                        <span>ÂïÜÂìÅÁÆ°ÁêÜ</span>
                    </el-menu-item>
                    <el-menu-item index="4" @click="toOrderManage">
                        <el-icon><setting /></el-icon>
                        <span>ËÆ¢ÂçïÁÆ°ÁêÜ</span>
                    </el-menu-item>
                </el-menu>
            </el-aside>
            <el-main style="border-top: 1px solid rgb(227, 223, 223);border-left: 1px solid rgb(227, 223, 223);">
                <div class="main-container" style="height: 100%;">


                <template v-if=!isDetail>
                    <el-row>
                        <el-form :inline="true" :model="form">
                            <el-form-item label="ÂïÜÂìÅÁºñÂè∑"><el-input v-model="form.spuId" clearable /></el-form-item>
                            <el-form-item label="ÂïÜÂìÅÂàÜÁ±ª">
                                <el-select v-model="form.productCategory" placeholder="ËØ∑ÈÄâÊã©" style="width: 240px">
                                    <el-option v-for="item in options1" :key="item.value" :label="item.label" :value="item.value"/>
                                </el-select>
                            </el-form-item>
                            <el-form-item label="ÊâÄÂ±ûÂïÜÊà∑">
                                <el-select v-model="form.merchantId" placeholder="ËØ∑ÈÄâÊã©" style="width: 240px">
                                    <el-option v-for="item in options2" :key="item.value" :label="item.label" :value="item.value"/>
                                </el-select>
                            </el-form-item>
                            <el-form-item> <el-button type="primary" @click="onSearch">Êü•ËØ¢</el-button> </el-form-item>
                            <el-form-item> <el-button type="primary" @click="onDelete">ÈáçÁΩÆ</el-button> </el-form-item>
                        </el-form>
                        <el-form :inline="true" :model="form">
                            <el-form-item label="ÂïÜÂìÅÂêçÁß∞"><el-input v-model="form.spuName" clearable /></el-form-item>
                            <el-form-item label="ÂàõÂª∫Êó∂Èó¥"><el-date-picker v-model="form.createTime" type="date" placeholder="Pick a day" :size="form.size" value-format="YYYY-MM-DD" /></el-form-item>
                            <el-form-item label="‰∏äÊû∂Áä∂ÊÄÅ">
                                <el-select v-model="form.shelfStatus" placeholder="ËØ∑ÈÄâÊã©" style="width: 240px">
                                    <el-option v-for="item in options3" :key="item.value" :label="item.label" :value="item.value"/>
                                </el-select>
                            </el-form-item>
                            <el-form-item label="ÂÆ°ÊâπÁä∂ÊÄÅ">
                                <el-select v-model="form.approvalStatus" placeholder="ËØ∑ÈÄâÊã©" style="width: 240px">
                                    <el-option v-for="item in options4" :key="item.value" :label="item.label" :value="item.value"/>
                                </el-select>
                            </el-form-item>
                        </el-form>
                    </el-row>
                    <!--    Ë°®Ê†º-->
                    <el-row style="height: 80vh;" >
                        <vxe-grid v-bind="gridOptions" style="width: 100%;" stripe height="100%">
                            <!--            Êü•ËØ¢ÊåâÈíÆÔºà1.Á±ªÂûã 2.ÁÇπÂáªÂêéËß¶ÂèëÊñπÊ≥ï 3.ÊåâÈíÆÊòæÁ§∫ÂÜÖÂÆπÔºâ-->
                            <template #toolbar_buttons>
                                <el-button type="primary" @click="add">Êñ∞Â¢û</el-button>
                            </template>
                            <!--            Êìç‰Ωú-->
                            <template #operate="{ row }">
                                <el-button size="small" type="primary" @click="showDetailDialog(row)">Êü•Áúã</el-button>
                                <el-button size="small" type="primary" @click="edit(row)">ÂÆ°Ê†∏</el-button>
                                <el-button size="small" type="danger" @click="onRemove(row.spuId)">Âà†Èô§</el-button>
                            </template>
                            <!--            Êç¢È°µ-->
                            <template #pager>
                                <vxe-pager :layouts="['Sizes', 'PrevPage', 'Number', 'NextPage', 'Total']" v-model:current-page="page.current" v-model:page-size="page.size" :total="page.total" @page-change="onPageChange">
                                </vxe-pager>
                            </template>
                        </vxe-grid>
                        <!--       ÂÆ°Ê†∏ÂíåÊñ∞Â¢ûÈ°µÈù¢-->
                        <el-dialog v-model="showDialog" :title="isEdit ? 'ÂÆ°Ê†∏' : 'Êñ∞Â¢û'" width="600">
                            <el-form ref="editForm" :model="editForm" :rules="rules" label-width="auto">
                                <!--                ÂïÜÂìÅID-->
                                <el-form-item v-if="isEdit" label="ÂïÜÂìÅID" prop="spuId">
                                    <el-input v-model="editForm.spuId" :disabled="isEdit" maxlength="20" />
                                </el-form-item>
                                <!--                ÂïÜÂìÅÂêçÁß∞-->
                                <el-form-item label="ÂïÜÂìÅÂêçÁß∞" prop="spuName">
                                    <el-input v-model="editForm.spuName" maxlength="20" />
                                </el-form-item>
                                <!--                ÂïÜÂìÅÊèèËø∞-->
                                <el-form-item label="ÂïÜÂìÅÊèèËø∞" prop="spuDesc">
                                    <el-input v-model="editForm.spuDesc" maxlength="20" />
                                </el-form-item>
                                <!--                ÂïÜÂìÅÂàÜÁ±ª-->
                                <el-form-item label="ÂïÜÂìÅÂàÜÁ±ª">
                                    <el-select v-model="editForm.productCategory" placeholder="ËØ∑ÈÄâÊã©" style="width: 240px">
                                        <el-option v-for="item in options1" :key="item.value" :label="item.label" :value="item.value"/>
                                    </el-select>
                                </el-form-item>
                                <!--                ÊâÄÂ±ûÂïÜÊà∑-->
                                <el-form-item label="ÊâÄÂ±ûÂïÜÊà∑">
                                    <el-select v-model="editForm.merchantId" placeholder="ËØ∑ÈÄâÊã©" style="width: 240px">
                                        <el-option v-for="item in options2" :key="item.value" :label="item.label" :value="item.value"/>
                                    </el-select>
                                </el-form-item>
                                <!--                ‰∏ªÂõæ-->
                                <el-form-item label="‰∏ªÂõæ" prop="mainImage">
                                    <el-upload :show-MFile-list="false" :before-upload="uploadMainImage">
                                        <img v-if="editForm.mainImage"  :src="`/MFile/download?id=${editForm.mainImage}`" style="width: 100px; height: 100px" />
                                        <el-icon v-else><Plus /></el-icon>
                                    </el-upload>
                                </el-form-item>
                                <!--                Â§öÂõæÁâá-->
                                <!--                <el-form-item label="Â§öÂõæÁâá" prop="image">-->
                                <!--                    <el-upload v-model:file-list="fileList"-->
                                <!--                                list-type="picture-card"-->
                                <!--                               :auto-upload="false"-->
                                <!--                               multiple>-->
                                <!--                        <i class="el-icon-plus"></i>-->
                                <!--                    </el-upload>-->
                                <!--                </el-form-item>-->
                                <!--                <el-button @click="SubmitFileList(fileList)">Êèê‰∫§</el-button>-->
                                <el-button @click="specsDrawer = true">ÁÇπÂáªË∑≥ËΩ¨ÂïÜÂìÅËØ¶ÊÉÖÁºñÂÜô</el-button>
                                <div class="add-specs-drawer" v-if="specsDrawer">
                                    <el-drawer :title="drawerTitle" v-model="specsDrawer" size="80%" :direction="drawerDirection" resizable>
                                        <div class="border-box">
                                            <div class="border">
                                                <div class="name">ÂïÜÂìÅËßÑÊ†º</div>
                                                <div class="border-guige">
                                                    <div class="main-content">
                                                        <div class="specs" v-for="(item, index) in itemList" :key="index" style="margin-top: 20px;">
                                                            <div class="flex-guige">
                                                                <div>ËßÑÊ†ºÂêç</div>
                                                                <div class="width-input">
                                                                    <el-input v-model="item.specificationname" placeholder="ËØ∑ËæìÂÖ•ËßÑÊ†ºÂêç"></el-input>
                                                                </div>
                                                            </div>
                                                            <div class="flex-guige" style="margin-top: 20px">
                                                                <div>ËßÑÊ†ºÂÄº</div>
                                                                <div class="width-tag">
                                                                    <div class="spec-value-container" v-for="(tag, ins) in item.specificationvalue" :key="ins">
                                                                        <el-tag
                                                                                closable
                                                                                :disable-transitions="false"
                                                                                @close="handleClose(index, ins)">
                                                                            {{ tag.value }}
                                                                        </el-tag>
                                                                        <el-input-number
                                                                                class="spec-price-input"
                                                                                v-model="tag.price"
                                                                                :precision="2"
                                                                                :min="0"
                                                                                :step="0.01"
                                                                                :precision="2">
                                                                            <template #prefix>
                                                                                <span>Ôø•</span>
                                                                            </template>
                                                                        </el-input-number>
                                                                    </div>
                                                                    <el-input
                                                                            class="input-new-tag"
                                                                            v-if="inpurIndex == index && inputVisible"
                                                                            v-model="inputValue"
                                                                            ref="saveTagInput"
                                                                            size="small"
                                                                            placeholder="ËßÑÊ†ºÂÄº"
                                                                            @keyup.enter.native="handleInputConfirm"
                                                                            @blur="handleInputConfirm"
                                                                            @focus="focusConfirm(index)">
                                                                    </el-input>
                                                                    <el-button v-else class="button-new-tag" size="small" @click="showInput(index)">+ ËßÑÊ†ºÂÄº</el-button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="detail-img">
                                                            <span>Ê∑ªÂä†ÂïÜÂìÅËØ¶ÁªÜÂõæÔºö</span>
                                                            <el-upload v-model:file-list="fileList"
                                                                       list-type="picture-card"
                                                                       :auto-upload="false"
                                                                       multiple>
                                                                <i class="el-icon-plus"></i>
                                                            </el-upload>
                                                        </div>
                                                    </div>
                                                    <div class="flex-guige" style="margin-top: 20px">
                                                        <el-button type="primary" plain size="small" @click="addValue">Ê∑ªÂä†ËßÑÊ†ºÈ°π</el-button>
                                                        <el-button type="danger" size="small" plain @click="deleteValue">Ê∏ÖÁ©∫ËßÑÊ†ºÈ°π</el-button>
                                                        <el-button type="danger" size="small" plain @click="deleteSpcesValue">Ê∏ÖÁ©∫ËßÑÊ†ºÂÄº</el-button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="border" style="margin-top:20px">
                                                <div class="name">ËßÑÊ†ºÊòéÁªÜ</div>
                                                <div class="map-list-container">
                                                    <el-table :data="mapList" border style="width: 100%">
                                                        <el-table-column v-for="(item, index) in itemList" :key="index" :label="item.specificationname" width='180'>
                                                            <template #default="scope">
                                                                <div v-if="scope.row.sku[index]">{{ scope.row.sku[index].value }}</div>
                                                            </template>
                                                        </el-table-column>
                                                        <el-table-column prop="groupName" label="Â∫ìÂ≠ò" width='120'>
                                                            <template #default="scope">
                                                                <el-input v-model="scope.row.stock" placeholder="Â∫ìÂ≠ò" type="number" min="0"></el-input>
                                                            </template>
                                                        </el-table-column>
                                                        <el-table-column prop="address" label="ÂîÆ‰ª∑" width='120'>
                                                            <template #default="scope">
                                                                <div>{{ calculateTotalPrice(scope.row.sku) }}</div>
                                                            </template>
                                                        </el-table-column>
                                                        <el-table-column fixed="right" align="center" width="230" label="Êìç‰Ωú">
                                                            <template #default="scope">
                                                                <el-button type="primary" size="small" @click="">‰øùÂ≠ò</el-button>
                                                            </template>
                                                        </el-table-column>
                                                    </el-table>
                                                </div>
                                            </div>
                                        </div>
                                    </el-drawer>
                                </div>
                                <!--                ‰∏äÊû∂Áä∂ÊÄÅ-->
                                <el-form-item v-if="isEdit" label="‰∏äÊû∂Áä∂ÊÄÅ">
                                    <el-select v-model="editForm.shelfStatus" placeholder="ËØ∑ÈÄâÊã©" style="width: 240px">
                                        <el-option v-for="item in options3" :key="item.value" :label="item.label" :value="item.value"/>
                                    </el-select>
                                </el-form-item>
                                <!--                ÂÆ°ÊâπÁä∂ÊÄÅ-->
                                <el-form-item v-if="isEdit" label="ÂÆ°ÊâπÁä∂ÊÄÅ">
                                    <el-select v-model="editForm.approvalStatus" placeholder="ËØ∑ÈÄâÊã©" style="width: 240px">
                                        <el-option v-for="item in options4" :key="item.value" :label="item.label" :value="item.value"/>
                                    </el-select>
                                </el-form-item>
                            </el-form>
                            <template #footer>
                                <el-button type="primary" @click="onSubmit">Êèê‰∫§</el-button>
                                <el-button @click="showDialog = false">ÂèñÊ∂à</el-button>
                            </template>
                        </el-dialog>
                    </el-row>
                </template>
                <!--    ËØ¶ÁªÜË°®ÔºàspuÂ±ÇÈù¢Ôºâ-->
                <template v-else-if='isDetail'>
                    <el-button text="plain" @click="isDetail = false"> < ËøîÂõû</el-button>
                    <el-descriptions
                            title="üìñÂïÜÂìÅËØ¶ÁªÜ"
                            direction="vertical"
                            border
                            style="margin-top: 20px"
                    >
                        <el-descriptions-item
                                :rowspan="3"
                                :width="140"
                                label="Â§¥ÂÉè"
                                align="center"
                        >
                            <div>
                                <img v-if="detailForm.mainImage" :src="`/MFile/download?id=${detailForm.mainImage}`" style="width: 100px; height: 100px" />
                                <el-icon v-else><Plus /></el-icon>
                            </div>
                        </el-descriptions-item>
                        <el-descriptions-item label="ÂïÜÂìÅÁºñÂè∑">{{detailForm.spuId}}</el-descriptions-item>
                        <el-descriptions-item label="ÂïÜÂìÅÂêçÁß∞">{{detailForm.spuName}}</el-descriptions-item>
                        <el-descriptions-item label="ÂïÜÂìÅËØ¶ÁªÜ">{{detailForm.spuDesc}}</el-descriptions-item>
                        <el-descriptions-item label="ÊâÄÂ±ûÂïÜÊà∑">{{detailForm.merchantId}}</el-descriptions-item>
                        <el-descriptions-item label="ÂïÜÂìÅÁ±ªÂûã">{{detailForm.productCategory}}</el-descriptions-item>
                        <el-descriptions-item label="ÂÆ°ÊâπÁä∂ÊÄÅ">{{detailForm.approvalStatus}}</el-descriptions-item>
                        <el-descriptions-item label="‰∏äÊû∂Áä∂ÊÄÅ">{{detailForm.shelfStatus}}</el-descriptions-item>
                        <el-descriptions-item label="ÈîÄÈáè">{{detailForm.sales}}</el-descriptions-item>
                        <el-descriptions-item label="ÂàõÂª∫Êó∂Èó¥">{{detailForm.createTime}}</el-descriptions-item>
                    </el-descriptions>
                </template>
                </div>
            </el-main>
            </el-container>
            </el-container>
        </el-container>
    </div>
</div>
</body>
<script>

    const app =  Vue.createApp({
        data() {
            return {
                itemNumber:'3',
                //----------------------------------Ê∑ªÂä†ÂïÜÂìÅËßÑÊ†º
                drawerTitle:'ÂïÜÂìÅËßÑÊ†ºÊ∑ªÂä†',
                fileList: [],
                dialogVisible: false,
                inputVisible: false,
                inputValue: "",
                itemList: [
                    // {
                    //     specificationname: 'ÂåÖË£Ö',
                    //     specificationvalue: [{ value: "Á∫∏Ë¥®", price: 18 }],
                    // },
                    // {
                    //     specificationname: 'Âè£Âë≥',
                    //     specificationvalue: [{ value: "Ëæ£", price: 18 }],
                    // },
                    // {
                    //     specificationname: 'Â∞∫ÂØ∏',
                    //     specificationvalue: [{ value: "Â§ß", price: 18 }],
                    // },
                ],
                inpurIndex: 0,
                mapList: [],
                resultData: null,
                skuCounter: 0 ,
                drawerDirection:'btt',
                specsDrawer:false,
                //----------------------------------

                dialogImageUrl: '',
                dialogVisible: false,
                // Êü•ËØ¢ÁïåÈù¢
                form: {
                    spuId: '',
                    productCategory: '',
                    merchantId: '',
                    spuName: '',
                    createTime: '',
                    shelfStatus: '',
                    approvalStatus: ''
                },
                //ÂïÜÂìÅÂàÜÁ±ªÁöÑÈÄâÊã©Âô®
                options1: [
                    {
                        value: 'Êµ∑È≤ú',
                        label: 'Êµ∑È≤ú',
                    },
                    {
                        value: 'Á¢≥ÁÉ§È£üÂìÅ',
                        label: 'Á¢≥ÁÉ§È£üÂìÅ',
                    },
                    {
                        value: 'Ê∞¥Êûú',
                        label: 'Ê∞¥Êûú',
                    },
                ],
                //ÂïÜÊà∑ÂêçÂàÜÁ±ªÁöÑÈÄâÊã©Âô®
                options2: [
                    {
                        value: '1973386479124234242',
                        label: 'ÁÉßÁÉ§Â∫ó',
                    },
                    {
                        value: '1973385448478883842',
                        label: 'Ê∞¥‰∫ß‰∏ìÂçñÂ∫ó',
                    },
                    {
                        value: '1973386025069854721',
                        label: 'Ê∞¥ÊûúÂ∫ó',
                    },
                ],
                //‰∏äÊû∂Áä∂ÊÄÅÁöÑÈÄâÊã©Âô®
                options3: [
                    {
                        value: 'on',
                        label: '‰∏äÊû∂',
                    },
                    {
                        value: 'off',
                        label: '‰∏ãÊû∂',
                    },
                ],
                //ÂÆ°ÊâπÁä∂ÊÄÅÁöÑÈÄâÊã©Âô®
                options4: [
                    {
                        value: 'pending',
                        label: 'ÂæÖÂÆ°Ê†∏',
                    },
                    {
                        value: 'approved',
                        label: 'Â∑≤ÂÆ°Ê†∏',
                    },
                    {
                        value: 'rejected',
                        label: 'Â∑≤ÊãíÁªù',
                    },
                ],
                // Ë°®Ê†º
                gridOptions: {
                    border: true,
                    height: 400,
                    data: [],
                    headerAlign: 'center',
                    align: 'center',
                    columns: [
                        {type: 'seq', width: 60},
                        {field: 'spuId', title: 'ÂïÜÂìÅÁºñÂè∑'},
                        {field: 'spuName', title: 'ÂïÜÂìÅÂêçÁß∞'},
                        {field: 'merchantId', title: 'ÊâÄÂ±ûÂïÜÊà∑'},
                        {field: 'shelfStatus', title: '‰∏äÊû∂Áä∂ÊÄÅ'},
                        {field: 'productCategory', title: 'ÂïÜÂìÅÂàÜÁ±ª'},
                        {field: 'createTime', title: 'ÂàõÂª∫Êó∂Èó¥'},
                        {field: 'totalStock', title: 'SPUÂ∫ìÂ≠ò'},
                        {field: 'sales', title: 'ÈîÄÈáè'},
                        {field: 'approvalStatus', title: 'ÂÆ°ÊâπÁä∂ÊÄÅ'},
                        {title: 'Êìç‰Ωú', slots: {default: 'operate'}, width: 220}
                    ],
                    toolbarConfig: {
                        custom: true,
                        slots: {buttons: 'toolbar_buttons'}
                    },
                },
                page: {
                    current: 1,
                    size: 20,
                    total: 0
                },
                //ÁºñËæë
                showDialog: false,
                //Êñ∞Â¢û
                isEdit: false,
                //ÁºñËæëÂíåÊñ∞Â¢ûÁöÑÁïåÈù¢
                editForm: {
                    //spuË°®
                    spuId: '',
                    spuName: '',
                    spuDesc: '',
                    productCategory: '',
                    merchantId: '',
                    mainImage: '',
                    shelfStatus: '',
                    approvalStatus: '',
                    elementSpecs: '',
                    specsPrice:'',
                    imageUrl: '',
                    stock:'',
                },
                // ËØ¶ÁªÜÂÜÖÂÆπ
                isDetail: false,
                detailForm: {
                    mainImage: '',
                    spuId: '',
                    spuName: '',
                    spuDesc: '',
                    productCategory: '',
                    merchantId: '',
                    approvalStatus: '',
                    shelfStatus: '',
                    sales: '',
                    createTime: '',
                },
                rules: {
                },
            };
        },
        async created() {
            await this.getList();
        },
        methods: {
            //----------------------------------Ê∑ªÂä†ÂïÜÂìÅËßÑÊ†º
            //‰øùÂ≠òÂõæÁâá
            SubmitFileList() {
                let fileListId = [];
                const data = new FormData();
                if (this.fileList.length <= 0) {
                    return fileListId;
                }
                this.fileList.forEach(file => {
                    data.append('files', file.raw);
                });
                axios.post('/MFile/uploadList', data, {
                    headers: {
                        'Content-Type': 'multipart/form-data'
                    }
                }).then(response =>{
                    if(response.status === 200){
                        this.$message({
                            message:'ÂØºÂÖ•ÊàêÂäü',
                            type:'success'
                        })
                        fileListId =  response.data;
                        return true;
                    }else{
                        this.$message({
                            message:'ÂØºÂÖ•Â§±Ë¥•',
                            type:'error'
                        })
                        return false;
                    }
                });
                return fileListId;
            },

            // ÊûÑÂª∫ÊúÄÁªàÊï∞ÊçÆÁªìÊûÑ
            buildFinalData() {
                return this.mapList.map(row => {
                    // ÊûÑÂª∫elementSpecsÂØπË±°
                    const elementSpecs = {};
                    // ÊûÑÂª∫specsPriceÂØπË±°
                    const specsPrice = {};

                    // ÈÅçÂéÜÊØè‰∏™ËßÑÊ†ºÂÄº
                    row.sku.forEach((spec, index) => {
                        // Ëé∑ÂèñËßÑÊ†ºÂêçÁß∞
                        const specName = this.itemList[index].specificationname;
                        // Ê∑ªÂä†Âà∞elementSpecs
                        elementSpecs[specName] = spec.value;
                        // Ê∑ªÂä†Âà∞specsPrice
                        specsPrice[spec.value] = spec.price.toString();
                    });

                    return {
                        specsPrice,
                        stock: row.stock.toString(), // Â∫ìÂ≠ò
                        elementSpecs,
                        imageUrl: this.SubmitFileList(), // ÂõæÁâáURLÊï∞ÁªÑ
                    };
                });
            },

            // ËÆ°ÁÆóÁªÑÂêàÊÄª‰ª∑
            calculateTotalPrice(skuArray) {
                if (!skuArray || !skuArray.length) return 0;
                return skuArray.reduce((total, item) => {
                    return total + (parseFloat(item.price) || 0);
                }, 0).toFixed(2);
            },

            // ÁîüÊàêËßÑÊ†ºÁªÑÂêàÂàóË°®
            generateMapList() {
                let skuList = [];
                for (let item of this.itemList) {
                    if (item.specificationvalue && item.specificationvalue.length) {
                        skuList.push(item.specificationvalue);
                    }
                }

                if (skuList.length > 0) {
                    this.mapList = this.composeTableData(skuList);
                } else {
                    this.mapList = [];
                }
            },

            // Ê∑ªÂä†ËßÑÊ†ºÈ°π
            addValue() {
                this.itemList.push({
                    specificationname: "",
                    specificationvalue: [],
                });
                this.generateMapList();
            },

            // Ê∏ÖÁ©∫ËßÑÊ†ºÈ°π
            deleteValue() {
                if (confirm("Á°ÆÂÆöË¶ÅÊ∏ÖÁ©∫ÊâÄÊúâËßÑÊ†ºÈ°πÂêóÔºü")) {
                    this.itemList = [
                        { specificationname: "", specificationvalue: [] }
                    ];
                    this.mapList = [];
                    this.resultData = null;
                }
            },
            // Ê∏ÖÁ©∫ËßÑÊ†ºÂÄº
            deleteSpcesValue() {
                if (confirm("Á°ÆÂÆöË¶ÅÊ∏ÖÁ©∫ÊâÄÊúâËßÑÊ†ºÂÄºÂêóÔºü")) {
                    for (let item of this.itemList) {
                        item.specificationvalue = [];
                    }
                    this.mapList = [];
                    this.resultData = null;
                }
            },

            // Â§ÑÁêÜÂÖ≥Èó≠Ê†áÁ≠æ
            handleClose(index, ins) {
                this.itemList[index].specificationvalue.splice(ins, 1);
                this.generateMapList();
                this.resultData = null;
            },

            // ËÅöÁÑ¶Âà§Êñ≠ÊòØÂì™‰∏™Êï∞ÊçÆ
            focusConfirm(index) {
                this.inpurIndex = index;
            },

            // ÊòæÁ§∫ËæìÂÖ•Ê°Ü
            showInput(index) {
                this.inpurIndex = index;
                this.inputVisible = true;
                this.$nextTick(() => {
                    this.$refs.saveTagInput[0].focus();
                });
            },

            // Â§ÑÁêÜËæìÂÖ•Á°ÆËÆ§
            handleInputConfirm(e) {
                let inputValue = this.inputValue;
                if (inputValue) {
                    // Ê∑ªÂä†ÈªòËÆ§‰ª∑Ê†º0
                    this.itemList[this.inpurIndex].specificationvalue.push({
                        value: inputValue,
                        price: 0
                    });
                    this.generateMapList();
                    this.resultData = null;
                }
                this.inputVisible = false;
                this.inputValue = "";
            },

            // ÊéíÂàóÁªÑÂêàÁÆóÊ≥ï
            cartesianProductOf() {
                return Array.prototype.reduce.call(arguments, function (a, b) {
                    const result = []
                    a.forEach(item_a => {
                        b.forEach(item_b => {
                            result.push(item_a.concat(item_b))
                        })
                    })
                    return result
                }, [[]])
            },

            // Ëé∑ÂèñÁªÑÂêàÂ•ΩÁöÑskuËßÑÊ†ºÊï∞ÊçÆ
            composeTableData(sku_list) {
                const arr = this.cartesianProductOf(...sku_list)
                return arr.map(item => {
                    return {
                        sku: item,  // ÁªÑÂêàÂ•ΩÁöÑËßÑÊ†ºÊï∞ÁªÑ
                        stock: 0,   // Â∫ìÂ≠ò
                    }
                })
            },
            //----------------------------------
            // async SubmitFileList(fileList) {
            //     console.log(fileList);
            //     const data = new FormData();
            //     fileList.forEach(file => {
            //         data.append('files', file.raw);
            //     });
            //      const response = await axios.post('/MFile/uploadList', data, {
            //          headers: {
            //              'Content-Type': 'multipart/form-data'
            //          }
            //      });
            //      console.log(response);
            // },
            //Êü•ËØ¢
            async getList() {
                const form= this.form;
                const response= await axios.post('/MGoods/getList', { spuId: form.spuId, productCategory: form.productCategory, merchantId: form.merchantId, spuName: form.spuName, createTime: form.createTime, shelfStatus: form.shelfStatus, approvalStatus: form.approvalStatus, current: this.page.current, size: this.page.size});
                this.gridOptions.data= response.data.records;
                this.page.current= response.data.current;
                this.page.size= response.data.size;
                this.page.total= response.data.total;
                console.log(this.gridOptions.data);
            },
            //Êç¢È°µÁöÑÊõ¥Êñ∞
            onPageChange() {
                this.getList();
            },
            //ÁºñËæëÊåâÈíÆ
            async edit(product) {
                this.showDialog= true;
                this.isEdit= true;
                this.editForm.spuId= product.spuId;
                this.editForm.spuName= product.spuName;
                this.editForm.shelfStatus= product.shelfStatus;
                this.editForm.merchantId= product.merchantId;
                this.editForm.productCategory= product.productCategory;
                this.editForm.createTime= product.createTime;
                this.editForm.sales= product.sales;
                this.editForm.approvalStatus= product.approvalStatus;
                const response= await axios.post('/MGoods/getSkuBySpuId',{spuId: this.editForm.spuId});
                const elementSpecsArray = Object.keys(response.data.records[0].elementSpecs);
                const specsPriceArray = Object.keys(response.data.records[0].specsPrice);
                for (let i = 0; i < elementSpecsArray.length; i++) {
                    this.itemList.push({
                        specificationname: elementSpecsArray[i],
                        specificationvalue: [{
                            value: response.data.records[0].elementSpecs[elementSpecsArray[i]],
                            price: parseInt(response.data.records[0].specsPrice[specsPriceArray[i]])
                        }]
                    });
                }
                this.generateMapList();
            },
            //Êñ∞Â¢ûÊåâÈíÆ
            add() {
                this.showDialog= true;
                this.isEdit= false;
                this.editForm= {};
            },
            //Êü•ËØ¢ÊåâÈíÆ
            onSearch() {
                this.getList();
            },
            //ÈáçÁΩÆÊåâÈíÆ
            onDelete() {
                this.form.spuId = '';
                this.form.productCategory = '';
                this.form.merchantId = '';
                this.form.spuName = '';
                this.form.createTime = '';
                this.form.shelfStatus = '';
                this.form.approvalStatus = '';
            },
            //ÁßªÈô§ÂäüËÉΩ
            async onRemove(spuId) {
                await axios.post('/MGoods/remove', {spuId});
                await this.getList();
            },
            async uploadMainImage(f) {
                try {
                    const response = await axios.post('/MFile/upload', { MFile: f}, {
                        headers: { 'Content-Type': 'multipart/form-data' }
                    });
                    this.editForm.mainImage = response.data.id;
                    return false;
                } catch (error) {
                    console.error('‰∏ä‰º†Â§±Ë¥•', error);
                    // Ê∑ªÂä†ÈîôËØØÊèêÁ§∫
                }
            },
            async onSubmit() {
                this.$refs.editForm.validate(async valid =>{
                        if(valid) {
                            this.resultData = this.buildFinalData();
                            this.editForm.elementSpecs = this.resultData[0].elementSpecs;
                            this.editForm.specsPrice = this.resultData[0].specsPrice;
                            this.editForm.stock = this.resultData[0].stock;
                            this.editForm.imageUrl = this.resultData[0].imageUrl;
                            await axios.post(this.isEdit? '/MGoods/edit': '/MGoods/add',
                                this.editForm
                            ).then(response => {
                                if(response.status === 200) {
                                    this.getList();
                                    this.showDialog= false;
                                    this.itemList = [];
                                }
                            });

                        }
                    }
                );
            },

            showDetailDialog(product) {
                this.isDetail = true;
                this.detailForm.spuId = product.spuId;
                this.detailForm.spuName = product.spuName;
                this.detailForm.spuDesc = product.spuDesc;
                this.detailForm.mainImage = product.mainImage;
                this.detailForm.productCategory = product.productCategory;
                this.detailForm.merchantId = product.merchantId;
                this.detailForm.createTime = product.createTime;
                this.detailForm.approvalStatus = product.approvalStatus;
                this.detailForm.shelfStatus = product.shelfStatus;
                this.detailForm.sales = product.sales;
                this.detailForm.createTime = product.createTime;
            },
            toUserManage(){
                window.location.href = 'http://localhost:8080/userAdmin';
            },
            toMerchantManage(){
                window.location.href = 'http://localhost:8080/merchantAdmin';
            },
            toProductManage(){
                window.location.href = 'http://localhost:8080/productAdmin';
            },
            toOrderManage(){
                window.location.href = 'http://localhost:8080/orderAdmin';
            }
        },
        // mounted() {
        //     // ÂàùÂßãÂåñÊó∂ÁîüÊàêËßÑÊ†ºÁªÑÂêà ---tzlÔºöÊàëÊï∞ÊçÆÈÉΩÊ≤°‰Ω†ËøõÁöÑÂø´
        //     this.generateMapList();
        // },
    });
    for(const[key, component] of Object.entries(ElementPlusIconsVue)) {app.component(key, component)}
    app.use(ElementPlus).use(VxeUITable).mount('#app');
</script>
</html>